Info  : FreeRADIUS Version 4.0.0
Info  : Copyright 1999-2019 The FreeRADIUS server project and contributors
Info  : There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A
Info  : PARTICULAR PURPOSE
Info  : You may redistribute copies of FreeRADIUS under the terms of the
Info  : GNU General Public License
Info  : For more information about these matters, see the file named COPYRIGHT
Info  : Starting - reading configuration files ...
Debug : Including dictionary file "./raddb/dictionary"
Debug : including configuration file ./raddb/radiusd.conf
Debug : Including files in directory "./raddb/template.d/"
Debug : including configuration file ./raddb/template.d/default
Debug : including configuration file ./raddb/clients.conf
Debug : Including files in directory "./raddb/mods-enabled/"
Debug : including configuration file ./raddb/mods-enabled/detail.log
Debug : including configuration file ./raddb/mods-enabled/escape
Debug : including configuration file ./raddb/mods-enabled/eap
Debug : including configuration file ./raddb/mods-enabled/imap
Debug : including configuration file ./raddb/mods-enabled/echo
Debug : including configuration file ./raddb/mods-enabled/dhcpv4
Debug : including configuration file ./raddb/mods-enabled/utf8
Debug : including configuration file ./raddb/mods-enabled/always
Debug : including configuration file ./raddb/mods-enabled/digest
Debug : including configuration file ./raddb/mods-enabled/pap
Debug : including configuration file ./raddb/mods-enabled/expr
Debug : including configuration file ./raddb/mods-enabled/radutmp
Debug : including configuration file ./raddb/mods-enabled/radius
Debug : including configuration file ./raddb/mods-enabled/linelog
Debug : including configuration file ./raddb/mods-enabled/unix
Debug : including configuration file ./raddb/mods-enabled/detail
Debug : including configuration file ./raddb/mods-enabled/attr_filter
Debug : including configuration file ./raddb/mods-enabled/ntlm_auth
Debug : including configuration file ./raddb/mods-enabled/exec
Debug : including configuration file ./raddb/mods-enabled/files
Debug : including configuration file ./raddb/mods-enabled/chap
Debug : including configuration file ./raddb/mods-enabled/unpack
Debug : including configuration file ./raddb/mods-enabled/logintime
Debug : including configuration file ./raddb/mods-enabled/expiration
Debug : including configuration file ./raddb/mods-enabled/cache_eap
Debug : including configuration file ./raddb/mods-enabled/eap_inner
Debug : including configuration file ./raddb/mods-enabled/soh
Debug : including configuration file ./raddb/mods-enabled/delay
Debug : including configuration file ./raddb/mods-enabled/client
Debug : including configuration file ./raddb/mods-enabled/sradutmp
Debug : including configuration file ./raddb/mods-enabled/mschap
Debug : including configuration file ./raddb/mods-enabled/stats
Debug : including configuration file ./raddb/mods-enabled/passwd
Debug : Including files in directory "./raddb/policy.d/"
Debug : including configuration file ./raddb/policy.d/accounting
Debug : including configuration file ./raddb/policy.d/eap
Debug : including configuration file ./raddb/policy.d/abfab-tr
Debug : including configuration file ./raddb/policy.d/time
Debug : including configuration file ./raddb/policy.d/canonicalisation
Debug : including configuration file ./raddb/policy.d/dhcp
Debug : including configuration file ./raddb/policy.d/cui
Debug : including configuration file ./raddb/policy.d/filter
Debug : including configuration file ./raddb/policy.d/operator-name
Debug : including configuration file ./raddb/policy.d/control
Debug : including configuration file ./raddb/policy.d/vendor
Debug : including configuration file ./raddb/policy.d/debug
Debug : Including files in directory "./raddb/sites-enabled/"
Debug : including configuration file ./raddb/sites-enabled/default
Info  : Loaded module "proto_radius"
Debug : including configuration file ./raddb/sites-enabled/inner-tunnel
Debug : Parsing security rules to bootstrap UID / GID / chroot / etc.
Debug : main {
Debug :   prefix = "/usr/local"
Debug :   security {
Debug :     allow_core_dumps = no
Debug :     allow_vulnerable_openssl = "no"
Debug :     openssl_fips_mode = no
Debug :   }
Debug :   name = radiusd
Debug :   local_state_dir = "/usr/local/var"
Debug :   run_dir = "/usr/local/var/run/radiusd"
Debug : }
Warn  : Ignoring configured UID / GID / chroot as we're running in debug mode
Debug : Parsing main configuration.
Debug : main {
Debug :   server default {
Debug :     namespace = "radius"
Debug :     listen {
Debug :       type = Access-Request
Info  : Loaded module "proto_radius_auth"
Debug :       Access-Request {
Debug :         log {
Debug :           stripped_names = no
Debug :           auth = no
Debug :           auth_badpass = no
Debug :           auth_goodpass = no
Debug :           msg_denied = "You are already logged in - access denied"
Debug :         }
Debug :         session {
Debug :           timeout = 15
Debug :           max = 4096
Debug :         }
Debug :       }
Debug :       type = Status-Server
Info  : Loaded module "proto_radius_status"
Debug :       transport = udp
Info  : Loaded module "proto_radius_udp"
Debug :       udp {
Debug :         ipaddr = *
Debug :         port = 1812
Debug :         networks {
Debug :           allow = 127/8
Debug :           allow = 192.0.2/24
Debug :         }
Debug :         max_packet_size = 4096
Debug :         max_attributes = 255
Debug :       }
Debug :       limit {
Debug :         cleanup_delay = 5
Debug :         idle_timeout = 60
Debug :         nak_lifetime = 30
Debug :         max_connections = 256
Debug :         max_clients = 256
Debug :         max_pending_packets = 256
Debug :       }
Debug :       priority {
Debug :         Access-Request = high
Debug :         Accounting-Request = low
Debug :         CoA-Request = normal
Debug :         Disconnect-Request = low
Debug :         Status-Server = now
Debug :       }
Debug :     }
Debug :     listen {
Debug :       type = Access-Request
Debug :       Access-Request {
Debug :         log {
Debug :           stripped_names = no
Debug :           auth = no
Debug :           auth_badpass = no
Debug :           auth_goodpass = no
Debug :           msg_denied = "You are already logged in - access denied"
Debug :         }
Debug :         session {
Debug :           timeout = 15
Debug :           max = 4096
Debug :         }
Debug :       }
Debug :       type = Status-Server
Debug :       transport = tcp
Info  : Loaded module "proto_radius_tcp"
Debug :       tcp {
Debug :         ipaddr = *
Debug :         port = 1812
Debug :         networks {
Debug :           allow = 127/8
Debug :           allow = 192.0.2/24
Debug :         }
Debug :         max_packet_size = 4096
Debug :         max_attributes = 255
Debug :       }
Debug :       limit {
Debug :         cleanup_delay = 5
Debug :         idle_timeout = 30
Debug :         nak_lifetime = 30
Debug :         max_connections = 1024
Debug :         max_clients = 256
Debug :         max_pending_packets = 256
Debug :       }
Debug :       priority {
Debug :         Access-Request = high
Debug :         Accounting-Request = low
Debug :         CoA-Request = normal
Debug :         Disconnect-Request = low
Debug :         Status-Server = now
Debug :       }
Debug :     }
Debug :     listen {
Debug :       type = Accounting-Request
Info  : Loaded module "proto_radius_acct"
Debug :       transport = udp
Debug :       udp {
Debug :         ipaddr = *
Debug :         port = 1813
Debug :         networks {
Debug :         }
Debug :         max_packet_size = 4096
Debug :         max_attributes = 255
Debug :       }
Debug :       limit {
Debug :         cleanup_delay = 5
Debug :         idle_timeout = 30
Debug :         nak_lifetime = 30
Debug :         max_connections = 1024
Debug :         max_clients = 256
Debug :         max_pending_packets = 256
Debug :       }
Debug :       priority {
Debug :         Access-Request = high
Debug :         Accounting-Request = low
Debug :         CoA-Request = normal
Debug :         Disconnect-Request = low
Debug :         Status-Server = now
Debug :       }
Debug :     }
Debug :   }
Debug :   server inner-tunnel {
Debug :     namespace = "radius"
Debug :     listen {
Debug :       type = Access-Request
Debug :       Access-Request {
Debug :         log {
Debug :           stripped_names = no
Debug :           auth = no
Debug :           auth_badpass = no
Debug :           auth_goodpass = no
Debug :           msg_denied = "You are already logged in - access denied"
Debug :         }
Debug :         session {
Debug :           timeout = 15
Debug :           max = 4096
Debug :         }
Debug :       }
Debug :       transport = udp
Debug :       udp {
Debug :         ipaddr = 127.0.0.1
Debug :         port = 18120
Debug :         networks {
Debug :         }
Debug :         max_packet_size = 4096
Debug :         max_attributes = 255
Debug :       }
Debug :       limit {
Debug :         cleanup_delay = 5
Debug :         idle_timeout = 30
Debug :         nak_lifetime = 30
Debug :         max_connections = 1024
Debug :         max_clients = 256
Debug :         max_pending_packets = 256
Debug :       }
Debug :       priority {
Debug :         Access-Request = high
Debug :         Accounting-Request = low
Debug :         CoA-Request = normal
Debug :         Disconnect-Request = low
Debug :         Status-Server = now
Debug :       }
Debug :     }
Debug :   }
Debug :   security {
Debug :   }
Debug :   sbin_dir = "/usr/local/sbin"
Debug :   logdir = "/usr/local/var/log/radius"
Debug :   radacctdir = "/usr/local/var/log/radius/radacct"
Debug :   reverse_lookups = no
Debug :   hostname_lookups = yes
Debug :   max_request_time = 30
Debug :   pidfile = "/usr/local/var/run/radiusd/radiusd.pid"
Debug :   debug_level = 0
Debug :   log {
Debug :     colourise = yes
Debug :   }
Debug :   resources {
Debug :   }
Debug :   thread pool {
Debug :     num_networks = 1
Debug :     num_workers = 4
Debug :   }
Debug : }
[1mSwitching to configured log settings[0m
radiusd: #### Loading Clients ####
  client localhost {
    ipaddr = 127.0.0.1
    require_message_authenticator = no
    secret = <<< secret >>>
    proto = "*"
    limit {
      max_connections = 16
      lifetime = 0
      idle_timeout = 30
    }
  }
  client localhost_ipv6 {
    ipv6addr = ::1
    require_message_authenticator = no
    secret = <<< secret >>>
    limit {
      max_connections = 16
      lifetime = 0
      idle_timeout = 30
    }
  }
[1mDebugger not attached[0m
[1m[33mtrigger { ... } subsection not found, triggers will be disabled[0m
#### Bootstrapping listeners ####
Creating Auth-Type = pap
Creating Auth-Type = imap
Creating Auth-Type = chap
Creating Auth-Type = mschap
Creating Auth-Type = digest
Creating Auth-Type = ldap
Creating Auth-Type = eap
    client localhost {
      ipaddr = 192.0.2.1
      require_message_authenticator = no
      secret = <<< secret >>>
      shortname = "sample"
      limit {
        max_connections = 16
        lifetime = 0
        idle_timeout = 30
      }
    }
#### Bootstrapping modules ####
 modules {
[1mLoaded module "rlm_detail"[0m
    detail auth_log {
      filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/auth-detail-%Y-%m-%d"
      header = "%t"
      permissions = 384
      locking = no
      escape_filenames = no
      log_packet_header = no
    }
    detail reply_log {
      filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/reply-detail-%Y-%m-%d"
      header = "%t"
      permissions = 384
      locking = no
      escape_filenames = no
      log_packet_header = no
    }
    detail pre_proxy_log {
      filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/pre-proxy-detail-%Y-%m-%d"
      header = "%t"
      permissions = 384
      locking = no
      escape_filenames = no
      log_packet_header = no
    }
    detail post_proxy_log {
      filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/post-proxy-detail-%Y-%m-%d"
      header = "%t"
      permissions = 384
      locking = no
      escape_filenames = no
      log_packet_header = no
    }
[1mLoaded module "rlm_escape"[0m
    escape {
      safe_characters = "@abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789.-_: /√§√©√∂√º√†√¢√¶√ß√®√©√™√´√Æ√Ø√¥≈ì√π√ª√ºa√ø√Ñ√â√ñ√ú√ü√Ä√Ç√Ü√á√à√â√ä√ã√é√è√î≈í√ô√õ√ú≈∏"
    }
Bootstrapping module "escape"
[1mLoaded module "rlm_eap"[0m
    eap {
      default_eap_type = md5
      type = md5
      type = gtc
      type = tls
      type = ttls
      type = mschapv2
      type = peap
      ignore_unknown_eap_types = no
      cisco_accounting_username_bug = no
    }
Bootstrapping module "eap"
[1mLoaded module "rlm_eap_md5"[0m
[1mLoaded module "rlm_eap_gtc"[0m
      gtc {
        challenge = "Password: "
        auth_type = PAP
      }
[1mLoaded module "rlm_eap_tls"[0m
      tls {
        tls = "tls-common"
        require_client_cert = yes
        include_length = yes
      }
[1mLoaded module "rlm_eap_ttls"[0m
      ttls {
        tls = "tls-common"
        virtual_server = "inner-tunnel"
        include_length = yes
        require_client_cert = no
      }
[1mLoaded module "rlm_eap_mschapv2"[0m
      mschapv2 {
        with_ntdomain_hack = no
        auth_type = mschap
        send_error = no
      }
[1mLoaded module "rlm_eap_peap"[0m
      peap {
        tls = "tls-common"
        proxy_tunneled_request_as_eap = yes
        virtual_server = "inner-tunnel"
        soh = no
        require_client_cert = no
      }
[1mrlm_curl - libcurl version: libcurl/7.69.1 SecureTransport zlib/1.2.11[0m
[1mLoaded module "rlm_imap"[0m
    imap {
      imap_URI = "imaps://mail.networkradius.com"
      tls {
        ca_file = "./raddb/certs/rsa/ca.pem"
        ca_path = "./raddb/certs/rsa"
        private_key_password = <<< secret >>>
        check_cert = yes
        check_cert_cn = yes
        extract_cert_attrs = yes
      }
    }
Bootstrapping module "imap"
[1mLoaded module "rlm_exec"[0m
    exec echo {
      wait = yes
      program = "/bin/echo %{User-Name}"
      input_pairs = "request"
      output_pairs = "reply"
      shell_escape = yes
    }
Bootstrapping module "echo"
[1mLoaded module "rlm_dhcpv4"[0m
[1mLoaded module "rlm_utf8"[0m
[1mLoaded module "rlm_always"[0m
    always reject {
      rcode = "reject"
      simulcount = 0
      mpp = no
    }
    always fail {
      rcode = "fail"
      simulcount = 0
      mpp = no
    }
    always ok {
      rcode = "ok"
      simulcount = 0
      mpp = no
    }
    always handled {
      rcode = "handled"
      simulcount = 0
      mpp = no
    }
    always invalid {
      rcode = "invalid"
      simulcount = 0
      mpp = no
    }
    always disallow {
      rcode = "disallow"
      simulcount = 0
      mpp = no
    }
    always notfound {
      rcode = "notfound"
      simulcount = 0
      mpp = no
    }
    always noop {
      rcode = "noop"
      simulcount = 0
      mpp = no
    }
    always updated {
      rcode = "updated"
      simulcount = 0
      mpp = no
    }
[1mLoaded module "rlm_digest"[0m
Bootstrapping module "digest"
[1mLoaded module "rlm_pap"[0m
    pap {
      normalise = yes
    }
Bootstrapping module "pap"
[1mLoaded module "rlm_expr"[0m
Bootstrapping module "expr"
[1mLoaded module "rlm_radutmp"[0m
    radutmp {
      filename = "/usr/local/var/log/radius/radutmp"
      username = "%{User-Name}"
      check_with_nas = yes
      permissions = 384
      caller_id = no
    }
[1mLoaded module "rlm_radius"[0m
    radius {
      transport = udp
[1mLoaded module "rlm_radius_udp"[0m
      udp {
        ipaddr = 127.0.0.1
        port = 1812
        secret = "testing123"
        max_packet_size = 4096
        max_send_coalesce = 1024
      }
      type = Access-Request
      type = Accounting-Request
      status_check {
        type = Status-Server
      }
      max_attributes = 255
      zombie_period = 10
      revive_interval = 3600
      pool {
        start = 1
        min = 1
        max = 8
        connecting = 1
        uses = 0
        lifetime = 0
        open_delay = 0.2
        close_delay = 1
        manage_interval = 0.2
        connection {
          connect_timeout = 3
          reconnect_delay = 5
        }
        request {
          per_connection_max = 2000
          per_connection_target = 1000
          free_delay = 10
        }
      }
      Access-Request {
        initial_rtx_time = 2
        max_rtx_time = 16
        max_rtx_count = 2
        max_rtx_duration = 30
      }
      Accounting-Request {
        initial_rtx_time = 2
        max_rtx_time = 16
        max_rtx_count = 5
        max_rtx_duration = 30
      }
      Status-Server {
        initial_rtx_time = 2
        max_rtx_time = 5
        max_rtx_count = 5
        max_rtx_duration = 30
      }
    }
Bootstrapping module "radius"
[1m[33mIgnoring "trunk.per_connection_max = 2000", forcing to "trunk.per_connection_max = 255"[0m
[1m[33mIgnoring "trunk.per_connection_target = 1000", forcing to "trunk.per_connection_target = 127"[0m
[1mLoaded module "rlm_linelog"[0m
    linelog {
      destination = "file"
      delimiter = "\n"
      format = This is a log message for %{User-Name}
      reference = messages.%{%{reply:Packet-Type}:-default}
      file {
        filename = "/usr/local/var/log/radius/linelog"
        permissions = 384
        escape_filenames = no
      }
      syslog {
        severity = "info"
      }
      unix {
      }
      tcp {
        server = localhost IPv4 address [127.0.0.1]
        port = 514
        timeout = 2
      }
      udp {
        server = localhost IPv4 address [127.0.0.1]
        port = 514
        timeout = 2
      }
    }
    linelog log_accounting {
      destination = "file"
      delimiter = "\n"
      format = 
      reference = Accounting-Request.%{%{Acct-Status-Type}:-unknown}
      file {
        filename = "/usr/local/var/log/radius/linelog-accounting"
        permissions = 384
        escape_filenames = no
      }
      syslog {
        severity = "info"
      }
      unix {
      }
      tcp {
        timeout = 1000
      }
      udp {
        timeout = 1000
      }
    }
[1mLoaded module "rlm_unix"[0m
    unix {
    }
Bootstrapping module "unix"
Creating attribute Unix-Group
    detail {
      filename = "/usr/local/var/log/radius/radacct/%{%{Packet-Src-IP-Address}:-%{Packet-Src-IPv6-Address}}/detail-%Y-%m-%d"
      header = "%t"
      permissions = 384
      locking = no
      escape_filenames = no
      log_packet_header = no
    }
[1mLoaded module "rlm_attr_filter"[0m
    attr_filter attr_filter.pre-proxy {
      filename = "./raddb/mods-config/attr_filter/pre-proxy"
      key = %{Realm}
      relaxed = no
    }
    attr_filter attr_filter.post-proxy {
      filename = "./raddb/mods-config/attr_filter/post-proxy"
      key = %{Realm}
      relaxed = no
    }
    attr_filter attr_filter.access_reject {
      filename = "./raddb/mods-config/attr_filter/access_reject"
      key = %{User-Name}
      relaxed = no
    }
    attr_filter attr_filter.access_challenge {
      filename = "./raddb/mods-config/attr_filter/access_challenge"
      key = %{User-Name}
      relaxed = no
    }
    attr_filter attr_filter.accounting_response {
      filename = "./raddb/mods-config/attr_filter/accounting_response"
      key = %{User-Name}
      relaxed = no
    }
    exec ntlm_auth {
      wait = yes
      program = "/path/to/ntlm_auth --request-nt-key --domain=MYDOMAIN --username=%{mschap:User-Name} --password=%{User-Password}"
      shell_escape = yes
    }
Bootstrapping module "ntlm_auth"
    exec {
      wait = yes
      input_pairs = "request"
      shell_escape = yes
      timeout = 10
    }
Bootstrapping module "exec"
[1mLoaded module "rlm_files"[0m
    files {
      filename = "./raddb/mods-config/files/authorize"
      acctusersfile = "./raddb/mods-config/files/accounting"
      preproxy_usersfile = "./raddb/mods-config/files/pre-proxy"
      key = %{%{Stripped-User-Name}:-%{User-Name}}
    }
[1mLoaded module "rlm_chap"[0m
Bootstrapping module "chap"
[1mLoaded module "rlm_unpack"[0m
Bootstrapping module "unpack"
[1mLoaded module "rlm_logintime"[0m
    logintime {
      minimum_timeout = 60
    }
[1mLoaded module "rlm_expiration"[0m
[1mLoaded module "rlm_cache"[0m
    cache cache_eap {
      driver = "rlm_cache_rbtree"
      key = %{%{control:State}:-%{%{reply:State}:-%{State}}}
      ttl = 15
      max_entries = 0
      epoch = 0
      add_stats = no
    }
Bootstrapping module "cache_eap"
[1mLoaded module "rlm_cache_rbtree"[0m
    eap inner-eap {
      default_eap_type = mschapv2
      type = md5
      type = gtc
      type = mschapv2
      type = tls
      ignore_unknown_eap_types = no
      cisco_accounting_username_bug = no
    }
Bootstrapping module "inner-eap"
      gtc {
        challenge = "Password: "
        auth_type = PAP
      }
      mschapv2 {
        with_ntdomain_hack = no
        auth_type = mschap
        send_error = no
      }
      tls {
        tls = "tls-peer"
        require_client_cert = yes
        include_length = yes
      }
[1mLoaded module "rlm_soh"[0m
    soh {
      dhcp = yes
    }
Bootstrapping module "soh"
[1mLoaded module "rlm_delay"[0m
    delay {
      delay = 1.0
      relative = no
      force_reschedule = no
    }
Bootstrapping module "delay"
    delay delay_reject {
      delay = %{%{reply:FreeRADIUS-Response-Delay}:-1}
      relative = yes
      force_reschedule = no
    }
Bootstrapping module "delay_reject"
[1mLoaded module "rlm_client"[0m
Bootstrapping module "client"
    radutmp sradutmp {
      filename = "/usr/local/var/log/radius/sradutmp"
      username = "%{User-Name}"
      check_with_nas = yes
      permissions = 420
      caller_id = no
    }
[1mLoaded module "rlm_mschap"[0m
    mschap {
      normalise = yes
      use_mppe = yes
      require_encryption = no
      require_strong = no
      with_ntdomain_hack = yes
      passchange {
      }
      allow_retry = yes
      use_open_directory = yes
      winbind {
      }
    }
Bootstrapping module "mschap"
[1mLoaded module "rlm_stats"[0m
    stats {
    }
[1mLoaded module "rlm_passwd"[0m
    passwd etc_passwd {
      filename = "/etc/passwd"
      format = "*User-Name:Crypt-Password:"
      delimiter = ":"
      ignore_nislike = no
      ignore_empty = yes
      allow_multiple_keys = no
      hash_size = 100
    }
  instantiate {
  }
 } # modules
#### Instantiating listeners ####
Compiling policies in server default { ... }
Compiling policies in - recv Access-Request {...}
[1m[33m./raddb/sites-enabled/default[887]: Ignoring "sql" as it is commented out[0m
[1m[33m./raddb/sites-enabled/default[903]: Ignoring "ldap" as it is commented out[0m
Compiling policies in - send Access-Accept {...}
[1m[33m./raddb/sites-enabled/default[1218]: Ignoring "sql" as it is commented out[0m
[1m[33m./raddb/policy.d/eap[78]: Please use the 'filter' keyword for attribute filtering[0m
Compiling policies in - send Access-Challenge {...}
Compiling policies in - send Access-Reject {...}
[1m[33m./raddb/sites-enabled/default[1342]: Ignoring "sql" as it is commented out[0m
[1m[33m./raddb/policy.d/eap[78]: Please use the 'filter' keyword for attribute filtering[0m
Compiling policies in - authenticate pap {...}
Compiling policies in - authenticate imap {...}
Compiling policies in - authenticate chap {...}
Compiling policies in - authenticate mschap {...}
Compiling policies in - authenticate digest {...}
Compiling policies in - authenticate ldap {...}
[1m[33m./raddb/sites-enabled/default[1077]: Ignoring "ldap" as it is commented out[0m
Compiling policies in - authenticate eap {...}
Compiling policies in - recv Status-Server {...}
Compiling policies in - recv Accounting-Request {...}
Compiling policies in - send Accounting-Response {...}
[1m[33m./raddb/sites-enabled/default[1558]: Ignoring "sql" as it is commented out[0m
Compiling policies in - accounting Start {...}
Compiling policies in - accounting Stop {...}
Compiling policies in - accounting Alive {...}
Compiling policies in - accounting Accounting-On {...}
Compiling policies in - accounting Accounting-Off {...}
Compiling policies in - accounting Failed {...}
[1m[33m./raddb/sites-enabled/default[717]: client localhost { ... } section is unused[0m
Compiling policies in server inner-tunnel { ... }
Compiling policies in - recv Access-Request {...}
[1m[33m./raddb/sites-enabled/inner-tunnel[124]: Ignoring "sql" as it is commented out[0m
[1m[33m./raddb/sites-enabled/inner-tunnel[134]: Ignoring "ldap" as it is commented out[0m
Compiling policies in - send Access-Accept {...}
[1m[33m./raddb/sites-enabled/inner-tunnel[269]: Ignoring "sql" as it is commented out[0m
Compiling policies in - send Access-Reject {...}
[1m[33m./raddb/sites-enabled/inner-tunnel[304]: Ignoring "sql" as it is commented out[0m
Compiling policies in - authenticate pap {...}
Compiling policies in - authenticate chap {...}
Compiling policies in - authenticate mschap {...}
Compiling policies in - authenticate eap {...}
#### Instantiating modules ####
Instantiating module "attr_filter.access_challenge"
Reading file ./raddb/mods-config/attr_filter/access_challenge
Instantiating module "attr_filter.access_reject"
Reading file ./raddb/mods-config/attr_filter/access_reject
Instantiating module "attr_filter.accounting_response"
Reading file ./raddb/mods-config/attr_filter/accounting_response
Instantiating module "attr_filter.post-proxy"
Reading file ./raddb/mods-config/attr_filter/post-proxy
Instantiating module "attr_filter.pre-proxy"
Reading file ./raddb/mods-config/attr_filter/pre-proxy
Instantiating module "auth_log"
rlm_detail (auth_log) - 'User-Password' suppressed, will not appear in detail output
Instantiating module "cache_eap"
Instantiating module "detail"
Instantiating module "disallow"
Instantiating module "eap"
Instantiating module "etc_passwd"
Instantiating module "expiration"
Instantiating module "fail"
Instantiating module "files"
Reading file ./raddb/mods-config/files/authorize
Reading file ./raddb/mods-config/files/accounting
Reading file ./raddb/mods-config/files/pre-proxy
Instantiating module "handled"
Instantiating module "imap"
Creating attribute imap-Paircmp
Instantiating module "inner-eap"
Instantiating module "invalid"
Instantiating module "linelog"
Instantiating module "log_accounting"
Instantiating module "logintime"
Instantiating module "mschap"
rlm_mschap (mschap) - Using internal authentication
Instantiating module "noop"
Instantiating module "notfound"
Instantiating module "ok"
Instantiating module "post_proxy_log"
Instantiating module "pre_proxy_log"
Instantiating module "radius"
Instantiating module "reject"
Instantiating module "reply_log"
Instantiating module "stats"
Instantiating module "updated"
Instantiating module "eap.mschapv2"
Instantiating module "eap.peap"
      tls-config tls-common {
        auto_chain = yes
        chain rsa {
          format = pem
          certificate_file = "./raddb/certs/rsa/server.pem"
          private_key_password = <<< secret >>>
          private_key_file = "./raddb/certs/rsa/server.key"
          ca_file = "./raddb/certs/rsa/ca.pem"
          verify_mode = hard
          include_root_ca = no
        }
        verify_depth = 0
        ca_path = "./raddb/certs"
        ca_file = "./raddb/certs/rsa/ca.pem"
        dh_file = "./raddb/certs/dh"
        fragment_size = 1024
        check_crl = no
        cipher_list = "DEFAULT"
        cipher_server_preference = yes
        allow_renegotiation = no
        ecdh_curve = "prime256v1"
        tls_min_version = 1.200000
        cache {
          name = %{EAP-Type}%{Virtual-Server}
          lifetime = 86400
          verify = no
          require_extended_master_secret = yes
          require_perfect_forward_secrecy = no
        }
        verify {
        }
        ocsp {
          enable = no
          override_cert_url = yes
          url = "http://127.0.0.1/ocsp/"
          use_nonce = yes
          timeout = 0
          softfail = no
        }
        staple {
          enable = no
          override_cert_url = yes
          url = "http://127.0.0.1/ocsp/"
          use_nonce = yes
          timeout = 0
          softfail = no
        }
      }
Instantiating module "eap.tls"
tls - Using cached TLS configuration from previous invocation
Instantiating module "eap.ttls"
tls - Using cached TLS configuration from previous invocation
Instantiating module "cache_eap.rbtree"
Instantiating module "inner-eap.mschapv2"
Instantiating module "inner-eap.tls"
      tls-config tls-peer {
        auto_chain = yes
        chain {
          format = pem
          certificate_file = "./raddb/certs/rsa/server.pem"
          private_key_password = <<< secret >>>
          private_key_file = "./raddb/certs/rsa/server.key"
          ca_file = "./raddb/certs/rsa/ca.pem"
          verify_mode = hard
          include_root_ca = no
        }
        verify_depth = 0
        ca_path = "./raddb/certs"
        ca_file = "./raddb/certs/rsa/ca.pem"
        dh_file = "./raddb/certs/dh"
        fragment_size = 16384
        check_crl = no
        cipher_server_preference = yes
        allow_renegotiation = no
        ecdh_curve = "prime256v1"
        tls_min_version = 1.200000
        cache {
          name = %{EAP-Type}%{Virtual-Server}
          lifetime = 86400
          verify = no
          require_extended_master_secret = yes
          require_perfect_forward_secrecy = no
        }
        verify {
        }
        ocsp {
          enable = no
          override_cert_url = no
          use_nonce = yes
          timeout = 0
          softfail = no
        }
        staple {
          enable = no
          override_cert_url = no
          use_nonce = yes
          timeout = 0
          softfail = no
        }
      }
radius - [0] Starting initial connection
radius - [1] Signalled to start from HALTED state
radius - [1] Connection changed state HALTED -> INIT
[1mradius - [1] Trunk connection changed state HALTED -> INIT[0m
radius - [1] Connection changed state INIT -> CONNECTING
[1mradius - [1] Trunk connection changed state INIT -> CONNECTING[0m
Scheduler created in single-threaded mode
#### Opening listener interfaces ####
Listening on radius address proto_radius_udp server * port 1812 bound to virtual server default
Listening on radius address proto_radius_tcp server * port 1812 bound to virtual server default
Listening on radius address proto_radius_udp server * port 1813 bound to virtual server default
Listening on radius address proto_radius_udp server 127.0.0.1 port 18120 bound to virtual server inner-tunnel
[1mReady to process requests[0m
radius - Sending Status-Server ID 247 length 0 over connection proto udp local 0.0.0.0 port 57615 remote 127.0.0.1 port 1812
radius - Originated request.  Expecting response within 2.387s
proto_radius_udp - Received Status-Server ID 247 length 75 proto_radius_udp server * port 1812
(0)  Received Status-Server ID 247 from 127.0.0.1:57615 to 127.0.0.1:1812 length 75 via socket proto_radius_udp server * port 1812
(0)    Event-Timestamp = "Mar 30 2020 20:46:05 UTC"
(0)    NAS-Identifier = "status check - are you alive?"
(0)    Message-Authenticator = 0x79c2556c058d92b38fc064930dbb4dd7
0 - Resetting cleanup timer to +30
(0)  Running request
(0)  Running 'recv Status-Server' from file ./raddb/sites-enabled/default
(0)  recv Status-Server {
(0)    ok (ok)
(0)  } # recv Status-Server (ok)
(0)  Running 'send Access-Accept' from file ./raddb/sites-enabled/default
(0)  send Access-Accept {
(0)    update {
(0)      Nothing to update
(0)    } # update (noop)
(0)    eap (noop)
(0)    remove_reply_message_if_eap {
(0)      if (&reply:EAP-Message && &reply:Reply-Message) {
(0)        ...
(0)      }
(0)      else {
(0)        noop (noop)
(0)      } # else (noop)
(0)    } # remove_reply_message_if_eap (noop)
(0)  } # send Access-Accept (noop)
(0)  Done request
(0)  Sending Access-Accept ID 247 from 127.0.0.1:1812 to 127.0.0.1:57615 length 20 via socket proto_radius_udp server * port 1812
(0)  Finished request
(radius)  Received Access-Accept ID 2 length 20 reply packet on connection proto udp local 0.0.0.0 port 57615 remote 127.0.0.1 port 1812
radius - Connection open - proto udp local 0.0.0.0 port 57615 remote 127.0.0.1 port 1812
radius - [1] Signalled connected from CONNECTING state
radius - [1] Connection changed state CONNECTING -> CONNECTED
radius - [1] Connection established
[1mradius - [1] Trunk connection changed state CONNECTING -> ACTIVE[0m
TIMER - proto_radius_udp - cleanup delay for ID 247
[1mSignalled to terminate[0m
[1mExiting normally[0m
radius - [1] Signalled to halt from CONNECTED state
radius - [1] Connection changed state CONNECTED -> CLOSED
[1mradius - [1] Trunk connection changed state ACTIVE -> CLOSED[0m
radius - Connection closed - proto udp local 0.0.0.0 port 57615 remote 127.0.0.1 port 1812
radius - [1] Connection changed state CLOSED -> HALTED
[1mradius - [1] Trunk connection changed state CLOSED -> HALTED[0m
