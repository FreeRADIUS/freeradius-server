= EAP-TTLS: Tunneled authentication

*Goal:* To configure the server to use the EAP-TTLS authentication
protocol and to send and receive test packets.

*Time:* 20-35 minutes.

*File:*

- `sites-available/default`
- `mods-config/files/authorize`
- `eapol_test/ttls-pap.conf`

*Diagram:*

image::eap-ttls.svg[Fig. TTLS Packet]

== What is EAP-TTLS?

`EAP-TTLS` (Extensible Authentication Protocol - Tunneled Transport Layer Security) works in two phases:

** Phase 1 — A TLS tunnel is established using a server-side certificate. This encrypts all further communication.
** Phase 2 — Inside the encrypted tunnel, the user's credentials are sent using an inner authentication method (e.g. PAP).

This means the username and password are always protected inside the TLS tunnel.

== Notes Before Setup

** During installation, the FreeRADIUS build system automatically creates certificates for use with TTLS. Little or no action is required to enable it.
** This guide does not cover configuring EAP-TTLS on a wireless client or access point. Consult your wireless client documentation for that.
** For initial testing, PAP is recommended as the tunneled (inner) authentication protocol.

== Files to Change

Add the user entry in `raddb/mods-config/files/authorize`:

[source, text]
----
bob    Password.Cleartext := "hello"
----

Update the following fields in `src/tests/eapol_test/ttls-pap.conf`:

[source, text]
----
network={
	key_mgmt=WPA-EAP
	eap=TTLS
	identity="bob"
	anonymous_identity="anonymous@example.org"
	ca_cert="raddb/certs/rsa/ca.pem"
	password="hello"
	phase2="auth=PAP"
}
----

== Questions

1.  How is EAP-TTLS easier to use than EAP-TLS?
2.  What authentication protocols may be carried inside of the TLS
tunnel for EAP-TTLS?
3.  Would you use EAP-TTLS in a large deployment? If so, why? If not,
why not?

// Copyright (C) 2021 Network RADIUS SAS.  Licenced under CC-by-NC 4.0.
// This documentation was developed by Network RADIUS SAS.
