lcp takes end_bit, not keylen any more
