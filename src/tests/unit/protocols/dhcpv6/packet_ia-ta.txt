#  -*- text -*-
#  Copyright (C) 2019 Network RADIUS SARL <legal@networkradius.com>
#  This work is licensed under CC-BY version 4.0 https://creativecommons.org/licenses/by/4.0
#
#  Version $Id$
#
#  Test vectors for DHCPv6 protocol
#
#  Based on https://github.com/the-tcpdump-group/tcpdump/blob/master/tests/dhcpv6-ia-ta.pcap
#

proto dhcpv6
proto-dictionary dhcpv6

#
#  1.
#
encode-proto Packet-Type = Solicit, Transaction-ID = 0x28b040, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Option-Request = DNS-Servers, Option-Request = Domain-List, Elapsed-Time = 0, IA-TA-IAID = 33752069
match 01 28 b0 40 00 01 00 0a 00 03 00 01 00 01 02 03 04 05 00 06 00 04 00 17 00 18 00 08 00 02 00 00 00 04 00 04 02 03 04 05

decode-proto -
match Packet-Type = Solicit, Transaction-ID = 0x28b040, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Option-Request = DNS-Servers, Option-Request = Domain-List, Elapsed-Time = 0, IA-TA-IAID = 33752069

#
#  2.
#
encode-proto Packet-Type = Advertise, Transaction-ID = 0x28b040, IA-TA-IAID = 33752069, IA-TA-Options = 0x000500182a000001000102005da2f92084c488cc0000119400001c20, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Server-ID-DUID = Server-ID-DUID-LLT, Server-ID-DUID-LLT-Hardware-Type = 1, Server-ID-DUID-LLT-Time = "Nov 27 1982 15:32:00 UTC", Server-ID-DUID-LLT-Link-Layer-Address = 0x001122334455
match 02 28 b0 40 00 04 00 20 02 03 04 05 00 05 00 18 2a 00 00 01 00 01 02 00 5d a2 f9 20 84 c4 88 cc 00 00 11 94 00 00 1c 20 00 01 00 0a 00 03 00 01 00 01 02 03 04 05 00 02 00 0e 00 01 00 01 18 46 47 f0 00 11 22 33 44 55

decode-proto -
match Packet-Type = Advertise, Transaction-ID = 0x28b040, IA-TA-IAID = 33752069, IA-TA-Options = 0x000500182a000001000102005da2f92084c488cc0000119400001c20, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Server-ID-DUID = Server-ID-DUID-LLT, Server-ID-DUID-LLT-Hardware-Type = 1, Server-ID-DUID-LLT-Time = "Nov 27 1982 15:32:00 UTC", Server-ID-DUID-LLT-Link-Layer-Address = 0x001122334455

#
#  3.
#
encode-proto Packet-Type = Request, Transaction-ID = 0x2b0e45, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Server-ID-DUID = Server-ID-DUID-LLT, Server-ID-DUID-LLT-Hardware-Type = 1, Server-ID-DUID-LLT-Time = "Nov 27 1982 15:32:00 UTC", Server-ID-DUID-LLT-Link-Layer-Address = 0x001122334455, Option-Request = DNS-Servers, Option-Request = Domain-List, Elapsed-Time = 0, IA-TA-IAID = 33752069, IA-TA-Options = 0x000500182a000001000102005da2f92084c488cc00001c2000001d4c
match 03 2b 0e 45 00 01 00 0a 00 03 00 01 00 01 02 03 04 05 00 02 00 0e 00 01 00 01 18 46 47 f0 00 11 22 33 44 55 00 06 00 04 00 17 00 18 00 08 00 02 00 00 00 04 00 20 02 03 04 05 00 05 00 18 2a 00 00 01 00 01 02 00 5d a2 f9 20 84 c4 88 cc 00 00 1c 20 00 00 1d 4c

decode-proto -
match Packet-Type = Request, Transaction-ID = 0x2b0e45, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Server-ID-DUID = Server-ID-DUID-LLT, Server-ID-DUID-LLT-Hardware-Type = 1, Server-ID-DUID-LLT-Time = "Nov 27 1982 15:32:00 UTC", Server-ID-DUID-LLT-Link-Layer-Address = 0x001122334455, Option-Request = DNS-Servers, Option-Request = Domain-List, Elapsed-Time = 0, IA-TA-IAID = 33752069, IA-TA-Options = 0x000500182a000001000102005da2f92084c488cc00001c2000001d4c

#
#  4.
#
encode-proto Packet-Type = Reply, Transaction-ID = 0x2b0e45, IA-TA-IAID = 33752069, IA-TA-Options = 0x000500182a000001000102005da2f92084c488cc0000119400001c20, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Server-ID-DUID = Server-ID-DUID-LLT, Server-ID-DUID-LLT-Hardware-Type = 1, Server-ID-DUID-LLT-Time = "Nov 27 1982 15:32:00 UTC", Server-ID-DUID-LLT-Link-Layer-Address = 0x001122334455
match 07 2b 0e 45 00 04 00 20 02 03 04 05 00 05 00 18 2a 00 00 01 00 01 02 00 5d a2 f9 20 84 c4 88 cc 00 00 11 94 00 00 1c 20 00 01 00 0a 00 03 00 01 00 01 02 03 04 05 00 02 00 0e 00 01 00 01 18 46 47 f0 00 11 22 33 44 55

decode-proto -
match Packet-Type = Reply, Transaction-ID = 0x2b0e45, IA-TA-IAID = 33752069, IA-TA-Options = 0x000500182a000001000102005da2f92084c488cc0000119400001c20, Client-ID-DUID = Client-ID-DUID-LL, Client-ID-DUID-LL-Hardware-Type = 1, Client-ID-DUID-LL-Address = 0x000102030405, Server-ID-DUID = Server-ID-DUID-LLT, Server-ID-DUID-LLT-Hardware-Type = 1, Server-ID-DUID-LLT-Time = "Nov 27 1982 15:32:00 UTC", Server-ID-DUID-LLT-Link-Layer-Address = 0x001122334455

count
match 18
