server hs-auto-accept {

	namespace = radius

	radius {
		Access-Request {
			session {
			}
		}
	}

	dictionary {
	}

	listen authentication {
		type = Access-Request
		type = Status-Server
		transport = udp
		require_message_authenticator = auto
		limit_proxy_state = auto
		limit {
			max_clients = 256
			max_connections = 256
			idle_timeout = 60.0
			dynamic_timeout = 600.0
			nak_lifetime = 30.0
			cleanup_delay = 5.0
		}
		udp {
			ipaddr = *
			port = 1812
			networks {
				allow = 127/8
				allow = 192.0.2/24
			}
		}
		tcp {
			ipaddr = *
			port = 1812
			networks {
				allow = 127/8
				allow = 192.0.2/24
			}
		}
	}

	listen authentication {
		type = Access-Request
		type = Status-Server
		transport = tcp
		tcp {
			ipaddr = *
			port = 1812
			networks {
				allow = 127/8
				allow = 192.0.2/24
			}
		}
	}

	listen accounting {
		type = Accounting-Request
		transport = udp
		udp {
			ipaddr = *
			port = 1813
		}
	}

	recv Access-Request {
		%linelog("hs-access-request-received - INFO - %Y-%m-%d-%H:%G:%e Homeserver %{Net.Dst.IP}:%{Net.Dst.Port} rx Access-Request src=%{Net.Src.IP}:%{Net.Src.Port} user=%{%{User-Name}} Calling-Station-Id=%{Calling-Station-Id}")
		accept
	}

	send Access-Accept {
		%linelog("hs-access-accept-sent - INFO - %Y-%m-%d-%H:%G:%e Homeserver %{Net.Dst.IP}:%{Net.Dst.Port} tx Access-Accept src=%{Net.Src.IP}:%{Net.Src.Port} dst=%{Net.Dst.IP}:%{Net.Dst.Port}")
	    	handled
	}

	recv Status-Server {
		ok
	}

	authenticate pap {
		pap
	}

	authenticate chap {
		chap
	}

	authenticate mschap {
		mschap
	}

	authenticate digest {
		digest
	}

	authenticate ldap {
		-ldap
	}

	authenticate eap {
		eap
	}

	send Access-Challenge {
		attr_filter.access_challenge
		handled
	}

	send Access-Reject {
		%linelog_test_framework("hs-access-reject-sent - ERROR - %Y-%m-%d-%H:%G:%e Homeserver %{Net.Dst.IP}:%{Net.Dst.Port} tx Access-Accept src=%{Net.Src.IP}:%{Net.Src.Port} dst=%{Net.Dst.IP}:%{Net.Dst.Port}")
		-sql
		attr_filter.access_reject
		eap
		remove_reply_message_if_eap
		delay_reject
	}

	recv Accounting-Request {
		acct_unique
		files_accounting
	}

	accounting Start {
		-sql
	}

	accounting Stop {
		-sql
	}

	accounting Interim-Update {
		-sql
	}

	accounting Accounting-On {
		-sql
	}

	accounting Accounting-Off {
		-sql
	}

	accounting Failed {
	}

	send Accounting-Response {
		detail
		attr_filter.accounting_response
	}
}
