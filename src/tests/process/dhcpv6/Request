subrequest @DHCPv6::Request {
	Transaction-ID = 0x1e291d

	Server-ID = {
		DUID = ::LLT
		LLT = {
			Hardware-Type = ::Ethernet
			Time = "Nov 21 2012 08:36:00 UTC"
			Ethernet = {
				Address = 00:11:22:33:44:55
			}
		}
	}

	Client-ID = {
		DUID = ::LL
		LL = {
			Hardware-Type = ::Ethernet
			Ethernet = {
				Address = 00:01:02:03:04:05
			}
		}
	}

	request += {
		Option-Request = DNS-Servers
		Option-Request = AFTR-Name
	}

	Elapsed-Time = 0

	call dhcpv6 {
		# 'Request' expects 'Reply'
		if (reply.Packet-Type != ::Reply) {
			test_fail
		}

		test_dhcpv6_reply_matches_request

#
#  Disabled at present pending UNION data types
#
if (0) {
		#
		#  This output omits the intermediate unions "Value"
		#
		%pairs.debug(reply.Server-ID)

		#
		#  The string output prints "Value.LLT", and "Value.Ethernet" here.
		#
		if (%pairs.print(reply.Server-Id) != 'Server-ID = { DUID = ::LLT, Value.LLT = { Hardware-Type = ::Ethernet, Time = "2012-11-21T08:36:00Z", Value.Ethernet = { Address = 00:11:22:33:44:55 } } }') {
			test_fail
		}

		if (!reply.Server-ID.DUID) {
			test_fail

		} elsif (reply.Server-ID.DUID != ::LLT) {
			test_fail
		}

		if (!reply.Server-ID.LLT) { # FAILS - LLT should be an alias to Value.LLT
			test_fail
		}

		if (!reply.Server-ID.Value.LLT) { # FAILS - Value.LLT should exist here!
			test_fail
		}

		if (!reply.Server-ID.LLT.Hardware-Type) {
			test_fail

		} elsif (reply.Server-ID.LLT.Hardware-Type != ::Ethernet) {
			test_fail
		}

		if (!reply.Server-ID.LLT.Time) {
			test_fail
		}

		if (!reply.Server-ID.LLT.Value.Ethernet.Address) {
			test_fail
		}
} # if (0)
	}
}
