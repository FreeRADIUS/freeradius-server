subrequest DHCPv6.Request {
	&Transaction-ID = 0x1e291d

	&Server-ID.DUID = LLT
	&Server-ID.DUID.LLT.Hardware-Type = Ethernet
	&Server-ID.DUID.LLT.Time = "Nov 21 2012 08:36:00 UTC"
	&Server-ID.DUID.LLT.Hardware-Type.Ethernet.Address = 00:11:22:33:44:55

	&Client-ID.DUID = LL
	&Client-ID.DUID.LL.Hardware-Type = Ethernet
	&Client-ID.DUID.LL.Hardware-Type.Ethernet.Address = 00:01:02:03:04:05

	&request += {
		&Option-Request = DNS-Servers
		&Option-Request = AFTR-Name
	}

	&Elapsed-Time = 0

	call dhcpv6 {
		# 'Request' expects 'Reply'
		if (&reply.Packet-Type != Reply) {
			test_fail
		}

		# We should reply the below attributes...
		if (!&reply.Transaction-ID) {
			test_fail
		}

		# ... Server-ID must be inside &reply
		if (!&reply.Server-ID.DUID.LLT.Hardware-Type) {
			test_fail
		}
		if (!&reply.Server-ID.DUID.LLT.Time) {
			test_fail
		}
		if (!&reply.Server-ID.DUID.LLT.Hardware-Type.Ethernet.Address) {
			test_fail
		}

		# ... these must be the same as in &request
		if (&reply.Transaction-ID != &request.Transaction-ID) {
			test_fail
		}

		if (&reply.Client-ID.DUID != &request.Client-ID.DUID) {
			test_fail
		}

		if (&request.Option-Request[*] == DNS-Servers) {
			if (&reply.DNS-Servers[*] != "2a01:cafe:1") {
				test_fail
			}
		}

		if (&request.Option-Request[*] == AFTR-Name) {
			if (&reply.AFTR-Name != "tapioca.net") {
				test_fail
			}
		}
	}
}
