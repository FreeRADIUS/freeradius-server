#
# PRE: map foreach
#
#  Test the map xlat
#
request += {
	Filter-Id = 'control.Filter-Id := \'testing123\''
	NAS-Port-Id = "request.Vendor-Specific.Nokia-SR.MSAP-Interface = 'UNICAST_7360OLT3'"
	NAS-Port-Id = "request.Vendor-Specific.Nokia-SR.MSAP-Interface += 'UNICAST_7360OLT4'"
	NAS-Identifier = 'control.Reply-Message = "Hello"'
	NAS-Identifier = 'request.Reply-Message = "Goodbye"'
}

if !%map(Filter-Id) {
	test_fail
}

if (!(control.Filter-Id == 'testing123')) {
	test_fail
}

foreach thing (NAS-Port-Id[*]) {
	if !%map(thing) {
		test_fail
	}
}

if (!(Vendor-Specific.Nokia-SR.MSAP-Interface[0] == 'UNICAST_7360OLT3')) {
	test_fail
}

if (!(Vendor-Specific.Nokia-SR.MSAP-Interface[1] == 'UNICAST_7360OLT4')) {
	test_fail
}

if !%map(NAS-Identifier[*]) {
	test_fail
}

if (control.Reply-Message != 'Hello') {
	test_fail
}
if (request.Reply-Message != 'Goodbye') {
	test_fail
}

success
