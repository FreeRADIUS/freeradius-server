#
# PRE: if
#
#  Remove all attributes in a list
#
&request.Tmp-Octets-0 := 0x5c5c
&request.Tmp-Octets-1 := 0x49206c696b6520636869636b656e2049206c696b65206c69766572
&request.Tmp-Octets-2 := 0x490049
&request.Tmp-Octets-3 := 0x00
&request.Tmp-Octets-4 := 0x7465737431
&request.Tmp-Octets-5 := 0x7465737432

&request.Tmp-String-0 := "%{string:%{request.Tmp-Octets-0}}"
&request.Tmp-String-1 := "%{string:%{request.Tmp-Octets-1}}"
&request.Tmp-String-2 := "%{string:%{request.Tmp-Octets-2}}"
&request.Tmp-String-3 := "%{string:%{request.Tmp-Octets-3}}"

if (<string>&request.Tmp-Octets-0 != &request.Tmp-String-0) {
	test_fail
}

if (<string>&request.Tmp-Octets-1 != &request.Tmp-String-1) {
	test_fail
}

if (<string>&request.Tmp-Octets-2 != &request.Tmp-String-2) {
	test_fail
}

if (<string>&request.Tmp-Octets-3 != &request.Tmp-String-3) {
	test_fail
}

if (&request.Tmp-String-0 != "\\\\") {
	test_fail
}

if (<string>&request.Tmp-Octets-0 != "%{string:%{request.Tmp-Octets-0}}") {
	test_fail
}

#
#  Test interpolation between string expansions and strings
#
if ("%{string:%{request.Tmp-Octets-4}}%{string:%{request.Tmp-Octets-5}}" != "test1test2") {
	test_fail
}

if ("test0%{string:%{request.Tmp-Octets-4}}%{string:%{request.Tmp-Octets-5}}" != "test0test1test2") {
	test_fail
}

if ("%{string:%{request.Tmp-Octets-4}}%{string:%{request.Tmp-Octets-5}}test3" != "test1test2test3") {
	test_fail
}

if (&request.Tmp-String-1 != 'I like chicken I like liver') {
	test_fail
}

if (&request.Tmp-String-2 != "I\000I") {
	test_fail
}

if (&request.Tmp-String-3 != "\000") {
	test_fail
}

success
