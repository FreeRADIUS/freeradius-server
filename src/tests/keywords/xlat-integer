#
# PRE:
#
&request.Tmp-String-0        := '9870'
&request.Tmp-String-1        := '98709870'
&request.Tmp-String-2        := '184467440737095516157'
&request.Tmp-Octets-0        := 0x39383731
&request.Tmp-Octets-1        := 0x3938373139383731
&request.Tmp-Octets-2        := 0x393837313938373139383731
&request.Tmp-IP-Address-0    := 57.56.55.50
&request.Tmp-Date-0          := 959985459
&request.Tmp-Integer-0       := 959985460
&request.Tmp-Cast-IfId       := '0000:0000:3938:3737'
&request.Tmp-Cast-IPv6Addr   := '::3938:3738'
&request.Tmp-Cast-IPv6Prefix := '::3938:3739/128'
&request.Tmp-Cast-Byte       := 58
&request.Tmp-Cast-Short      := 14139
&request.Tmp-Cast-Ether      := 00:00:39:38:37:3c
&request.Tmp-Cast-Integer64  := 1152921505566832445
&request.Tmp-Cast-IPv4Prefix := 57.56.55.62/32

# String - network order representation of a 4 char string
&request.Tmp-Integer-1 := "%(integer:%{request.Tmp-String-0})"
if ((<integer>&Tmp-String-0 != &request.Tmp-Integer-1) || (&request.Tmp-Integer-1 != 9870)) {
	test_fail
}

# String - network order representation of a 8 char string
&request.Tmp-uint64-0 := "%(integer:%{request.Tmp-String-1})"
if ((<integer64>&request.Tmp-String-1 != &request.Tmp-uint64-0) || (&request.Tmp-uint64-0 != 98709870)) {
	test_fail
}

# String - Can't convert 12 byte string to integer (our biggest native size is a 64bit unsigned int)
if ("%(integer:%{request.Tmp-String-2})") {
	test_fail
}

# Octets - network order representation of a 4 byte octet string
&request.Tmp-Integer-1 := "%(integer:%{request.Tmp-Octets-0})"

#
#  Disabled until xlats can return binary data
#
#if (&request.Tmp-Octets-0 != "%{hex:request.Tmp-Integer-1}") {
#	test_fail
#}
if (&request.Tmp-Integer-1 != 959985457) {
	test_fail
}

# Octets - network order representation of a 8 byte octet string
&request.Tmp-uint64-0 := "%(integer:%{request.Tmp-Octets-1})"

#
#  Disabled until xlats can return binary data
#
#if (&request.Tmp-Octets-1 != "%{hex:request.Tmp-uint64-0}") {
#	test_fail
#}

if (&Tmp-uint64-0 != 4123106143410599729) {
	test_fail
}

# String - Can't convert 12 byte octet string to integer (our biggest native size is a 64bit unsigned int)
if ("%(integer:%{request.Tmp-Octets-2})") {
	test_fail
}

&request.Tmp-String-2 := "%(integer:%{request.Tmp-IP-Address-0})"
&request.Tmp-String-3 := "%(integer:%{request.Tmp-Date-0})"
&request.Tmp-String-4 := "%(integer:%{request.Tmp-Integer-0})"
&request.Tmp-String-6 := "%(integer:%{request.Tmp-Cast-Ifid})"
&request.Tmp-String-7 := "%(integer:%{request.Tmp-Cast-IPv6Addr})"
&request.Tmp-String-8 := "%(integer:%{request.Tmp-Cast-IPv6Prefix})"

# IP Address
if (&request.Tmp-String-2 != '959985458') {
	test_fail
}

if (<ipaddr>&request.Tmp-String-2 != &request.Tmp-IP-Address-0) {
	test_fail
}

# Date
if (&request.Tmp-String-3 != '959985459') {
	test_fail
}

# Integer
if (&request.Tmp-String-4 != '959985460') {
	test_fail
}

# ifid - Can't convert interface ID to an integer
if (&request.Tmp-String-6 != '') {
	test_fail
}

# ipv6addr - Can't convert IPv6 to integer
if (&request.Tmp-String-7 != '959985464') {
	test_fail
}

# ipv6addrprefix
if (&request.Tmp-String-8 != '959985465') {
	test_fail
}

&request.Tmp-String-0 := "%(integer:%{request.Tmp-Cast-Byte})"
&request.Tmp-String-1 := "%(integer:%{request.Tmp-Cast-Short})"
&request.Tmp-uint64-2 := "%(integer:%{request.Tmp-Cast-Ether})"
&request.Tmp-String-3 := "%(integer:%{request.Tmp-Cast-Integer64})"
&request.Tmp-String-4 := "%(integer:%{request.Tmp-Cast-IPv4Prefix})"

# byte
if (&request.Tmp-String-0 != '58') {
	test_fail
}

# short
if (&request.Tmp-String-1 != '14139') {
	test_fail
}

# ethernet
if (&request.Tmp-uint64-2 != 959985468) {
	test_fail
}

#
#  The integer is in host order, so it's cast to an ethernet address,
#  with the lowest octet of the integer mapping to the right-most
#  ethernet octet (in network order)
#
if (<ether>&request.Tmp-uint64-2 != &request.Tmp-Cast-Ether) {
	test_fail
}

# integer64
if (&request.Tmp-String-3 != '1152921505566832445') {
	test_fail
}

# ipv4prefix
if (&request.Tmp-String-4 != '959985470') {
	test_fail
}

&request.Service-Type := Login-User
&request.Tmp-Integer-2 := "%(integer:%{request.Service-Type})"

if (&request.Tmp-Integer-2 != 1) {
	test_fail
}

success
