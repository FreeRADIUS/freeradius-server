#
# PRE: update
#

&request.Tmp-String-0 := "foo"
&request.Tmp-String-1 := "bar"

#
#  First choice
#
&request.Tmp-String-2 := "%{%{request.Tmp-String-0[0]}:-%{request.Tmp-String-1[0]}}"

if (&request.Tmp-String-2[0] != 'foo') {
	fail
}

#
#  Second choice
#
&request.Tmp-String-0 !* ANY
&request.Tmp-String-2 := "%{%{request.Tmp-String-0[0]}:-%{request.Tmp-String-1[0]}}"

if (&request.Tmp-String-2[0] != 'bar') {
	fail
}

#
#  Multiple things in an alternation
#
&request.Tmp-String-2 := "%{%{request.Tmp-String-0[0]}:-%{request.Tmp-String-1[0]} foo}"

if (&request.Tmp-String-2[0] != 'bar foo') {
	fail
}

#
#  Everything null
#
&request.Tmp-String-1 !* ANY
&request.Tmp-String-2 := "%{%{request.Tmp-String-0[0]}:-%{request.Tmp-String-1[0]}}"

if (!&request.Tmp-String-2[0] || (&request.Tmp-String-2[0] != "")) {
	fail
}

success
