#
#  PRE: update if
#
update control {
       Cleartext-Password := 'hello'
}

update reply {
	Filter-Id := "filter"
}

update control {
	Tmp-Cast-IPv4Prefix := 198.51.100.255/16
	Tmp-Cast-IPv6Prefix := ::198.51.100.255/112
	Framed-IP-Address := 198.51.0.1
}

if ("%{control:Tmp-Cast-IPv6Prefix}" != '::198.51.0.0/112') {
	update reply {
		Filter-Id += "Fail 0"
	}
}

if ("%{control:Tmp-Cast-IPv4Prefix}" != '198.51.0.0/16') {
	update reply {
		Filter-Id += "Fail 1"
	}
}

if (control:Tmp-Cast-IPv6Prefix != ::198.51.0.0/112) {
	update reply {
		Filter-Id += "Fail 2"
	}
}

if (control:Tmp-Cast-IPv4Prefix != 198.51.0.0/16) {
	update reply {
		Filter-Id += "Fail 3"
	}
}

if (!(&control:Tmp-Cast-IPv4Prefix < 198.0.0.0/8)) {
	update reply {
		Filter-Id += "Fail 4"
	}
}

if (!(&control:Framed-IP-Address < 198.51.0.0/16)) {
	update reply {
		Filter-Id += "Fail 5"
	}
}
