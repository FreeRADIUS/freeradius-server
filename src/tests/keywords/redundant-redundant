# PRE: update if foreach redundant redundant-load-balance
#
#  Nested redundant blocks.
#
#
&request.Tmp-Integer-2 := 0
&request.Tmp-Integer-3 := 0
&request.Tmp-Integer-4 := 0
&request.Tmp-Integer-5 := 0

redundant {
	redundant-load-balance {
		group {
			&request.Tmp-Integer-2 := "%{expr:&request.Tmp-Integer-2 + 1}"
			fail
		}
		group {
			&request.Tmp-Integer-3 := "%{expr:&request.Tmp-Integer-3 + 1}"
			fail
		}
		group {
			&request.Tmp-Integer-4 := "%{expr:&request.Tmp-Integer-4 + 1}"
			fail
		}
		group {
			&request.Tmp-Integer-5 := "%{expr:&request.Tmp-Integer-5 + 1}"
			fail
		}
	}
	ok
}

if (!ok) {
	&reply.Filter-Id := "did not return OK"
	return
}

if (&request.Tmp-Integer-2 != 1) {
	test_fail
	return
}

if (&request.Tmp-Integer-3 != 1) {
	test_fail
	return
}

if (&request.Tmp-Integer-4 != 1) {
	test_fail
	return
}

if (&request.Tmp-Integer-5 != 1) {
	test_fail
	return
}

success
