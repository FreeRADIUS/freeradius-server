#
#  PRE: update
#
&control.Tmp-Integer-0 := 5
&control.Tmp-Integer-0 += 10
&control.Tmp-Integer-0 += 15
&control.Tmp-Integer-0 += 20
&control.Tmp-String-0 := 'foo'
&control.Tmp-String-0 += 'baz'
&control.Tmp-String-0 += 'boink'

# Reset the request list
&request !* ANY
&request += &control[*]

debug_request

#
#  Integer ==
#
&request.Tmp-Integer-0 == 10

if (&request.Tmp-Integer-0[0] != 10) {
	test_fail
}

if ("%{request.Tmp-Integer-0[#]}" != 1) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 3) {
	test_fail
}

debug_request

# Reset the request list
&request !* ANY
&request += &control[*]

#
#  String ==
#
&request.Tmp-String-0 == 'baz'

if (&request.Tmp-String-0[0] != 'baz') {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 1) {
	test_fail
}

debug_request

# Reset the request list
&request !* ANY
&request += &control[*]

#
#  Integer <
#
&request.Tmp-Integer-0 < 10

if (&request.Tmp-Integer-0[0] != 5) {
	test_fail
}

if ("%{Trequest.mp-Integer-0[#]}" != 1) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 3) {
	test_fail
}

# Reset the request list
&request !* ANY
&request += &control[*]

#
#  Integer >
#
&request.Tmp-Integer-0 > 10

if (&request.Tmp-Integer-0[0] != 15) {
	test_fail
}

if (&request.Tmp-Integer-0[1] != 20) {
	test_fail
}


if ("%{request.Tmp-Integer-0[#]}" != 2) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 3) {
	test_fail
}

# Reset the request list
&request !* ANY
&request += &control[*]

#
#  Integer <=
#
&request.Tmp-Integer-0 <= 10

if (&request.Tmp-Integer-0[0] != 5) {
	test_fail
}

if (&request.mp-Integer-0[1] != 10) {
	test_fail
}

if ("%{request.Tmp-Integer-0[#]}" != 2) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 3) {
	test_fail
}

# Reset the request list
&request !* ANY
&request += &control[*]

#
#  Integer >=
#
&request.Tmp-Integer-0 >= 10

if (&request.Tmp-Integer-0[0] != 10) {
	test_fail
}

if (&request.Tmp-Integer-0[1] != 15) {
	test_fail
}

if (&request.Tmp-Integer-0[2] != 20) {
	test_fail
}

if ("%{request.Tmp-Integer-0[#]}" != 3) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 3) {
	test_fail
}

# Reset the request list
&request !* ANY
&request += &control[*]

#
#  Integer !=
#
&request.Tmp-Integer-0 != 10

if (&request.Tmp-Integer-0[0] != 5) {
	test_fail
}

if (&request.Tmp-Integer-0[1] != 15) {
	test_fail
}

if (&request.Tmp-Integer-0[2] != 20) {
	test_fail
}

if ("%{request.Tmp-Integer-0[#]}" != 3) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 3) {
	test_fail
}

# Reset the request list
&request !* ANY
&request += &control[*]

&request.Tmp-String-1 := 'baz'
&request.Tmp-String-1 += 'boink'

#
#  String (Intersection)
#
&request.Tmp-String-0 == &request.Tmp-String-1[0]

if (&request.Tmp-String-0[0] != &request.Tmp-String-1[0]) {
	test_fail
}

if ("%{request.Tmp-String-0[#]}" != 1) {
	test_fail
}

debug_request

&control.Auth-Type := Accept

success
